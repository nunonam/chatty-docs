# Push Notifications and Missed count badge


## 1. Register firebase credentials
- Required to register your firebase credential to send fcm messages to your chat members at dashboard

- Firebase console → project settings → service accounts → generate a new private key

- Export your key and upload the file

That's it. now you can receive push notifications 

![dashboard-firebase-credentials](/img/docs/dashboard-fcm-credentials.png)

<InfoBlock type="warning">
  If remote message does not received, Check 'deviceToken' of the member is registered or not. It can be confirmed at your Chatty.init() method
</InfoBlock>


## 2. Receiving remote message

```typescript

RemoteMessageType = {
  title: string,
  body: string,
  data: {
    type: 'CHATTY_NEW_MESSAGE',
    ChatId: 'ChatId',
    missedCount: {
      total: number,
      group: Array<{name: string, count: number}>
    },
  }
}

React.useEffect(() => {
  const unsubscribe = messaging().onMessage((message: FirebaseMessagingTypes.RemoteMessage) => {
    console.debug('Receiving Notification Message:', message);

    const activeScreen = navigation.getCurrentRoute().name;
    if (activeScreen !== 'Chat') {
      if (message.notification) {
        displayNotification({
          title: message.notification.title,
          body: message.notification.body,
          data: message.data,
        });
      }
    }

    dispatch(setChat({ missedCount: JSON.parse(message.data.missedCount) }));
    
  });
});
```

## 3. How to show missed count badge

Below code is a part of ChatButton.tsx
```typescript
ChatButton.tsx

import * as React from 'react';
import { View, AppState } from 'react-native';
import Chatty from 'chatty-client';


const ChatButton = (props: ChatButtonProps) => {
  const chat = useChat(); // get from global state (in this example, Reducer is used)
  
  const handleAppState = async (newState: string) => {
    if (newState === 'active') {
      const missedCount = Chatty.getMissedCount();
      store.dispatch(setChat({ missedCount: missedCount }));
    }
  }

  // call one more time when appstate is foreground from background
  React.useEffect(() => {
    const subscription = AppState.addEventListener('change', handleAppState);

    return () => {
      subscription.remove();
    };
  }, []);

  const handlePress = () => {
    navigation.navigate('ChatList');
  }

  return (
    <View>
      /* Button UI components*/
    </View>
  )
}
```

<NextBlock
  steps={[
    {
      text: 'Static Methods',
      link: '/reference/static-methods',
    },
  ]}
></NextBlock>
